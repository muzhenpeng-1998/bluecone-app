server:
  port: 80

spring:
  application:
    name: bluecone-app
  flyway:
    # 本地启动容忍缺失迁移，避免历史库校验失败；正式环境请关闭
    ignore-migration-patterns: "*:missing"
    validate-on-migrate: false

  datasource:
    url: jdbc:mysql://rm-bp1xld3504q1gtf6b9o.mysql.rds.aliyuncs.com:3306/app?useSSL=false&serverTimezone=Asia/Shanghai&characterEncoding=utf8
    username: muzhenpeng
    password: MUzhiwei123
    driver-class-name: com.mysql.cj.jdbc.Driver
    hikari:
      maximum-pool-size: 10
      minimum-idle: 2
      idle-timeout: 600000
      max-lifetime: 1800000
      connection-timeout: 30000

  data:
    redis:
      host: sh-crs-kwzgk7ez.sql.tencentcdb.com
      port: 29104
      database: 4
      username: root
      password: MUzhiwei123


mybatis-plus:
  enabled: true



bluecone:
  cache:
    l1:
      max-size: 20000
    l2:
      enabled: true
    consistency:
      redis:
        enabled: true
    profiles:
      user-profile:
        ttl-seconds: 600
        cache-null: true
      order-detail:
        ttl-seconds: 180
        strong-consistency: true
      tenant-config:
        ttl-seconds: 1800
        cache-null: false

  outbox:
    enabled: true
    publish-cron: "0/5 * * * * ?"    # 调试时 5 秒扫描一次
    clean-cron: "0 0 3 * * ?"        # 每日 3 点清理 DONE/DEAD
    max-retries: 5
    base-delay-seconds: 1
    max-delay-seconds: 300
    backoff-multiplier: 2.0
    dispatch-batch-size: 100
    clean-retention-days: 7
    consumption-dedup-days: 7

  storage:
    provider: ALIYUN_OSS
    aliyun:
      endpoint: "https://oss-cn-hangzhou.aliyuncs.com"
      access-key-id: "LTAI5tMZCj7ieTWeXX2kuEA1"
      access-key-secret: "i9DQDQ1y8ISRB4D0JqfBI0Pg800pU1"
      default-bucket: "bluecone"
      default-expire-seconds: 600
      cdn-domain: "https://cdn.bluecone.com"
      public-domain: "https://img.bluecone.com"

  resource:
    quota:
      default-daily-upload-count-limit: 2000
      default-daily-upload-bytes-limit: 10737418240
      tenant-overrides:
        1001:
          daily-upload-count-limit: 10000
          daily-upload-bytes-limit: 53687091200
        1002:
          daily-upload-count-limit: 500
          daily-upload-bytes-limit: 1073741824

  log:
    enabled: false

  id:
    long:
      enabled: true
      node-id: 1

logging:
  level:
    com.bluecone.app.infra.outbox: WARN
